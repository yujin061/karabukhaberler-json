      - name: Fetch and update JSON
        run: |
          node << 'EOF'
          const axios = require("axios");
          const fs = require("fs").promises;
          const iconv = require("iconv-lite");
          const cheerio = require("cheerio");

          // ... (önceki fonksiyonlar aynı)

          (async () => {
            try {
              console.log("JSON dosyası çekiliyor...");
              const response = await axios.get("https://services.karabuk.bel.tr/jsons-karabukbeltr/data/data-haberler.json", {
                headers: {
                  "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
                },
                responseType: 'arraybuffer'
              });

              // ... (önceki işlemler)

            } catch (error) {
              console.error("Bir hata oluştu:", error);
              
              // Hata detaylarını dosyaya yaz
              if (error.response) {
                try {
                  const rawData = error.response.data;
                  await fs.writeFile('error_response_raw.txt', rawData);
                  await fs.writeFile('error_response_utf8.txt', rawData.toString('utf8'));
                  console.log("Hata yanıtı error_response_*.txt dosyalarına kaydedildi");
                } catch (fileError) {
                  console.error("Hata yanıtı kaydedilemedi:", fileError);
                }
              }
              
              process.exit(1);
            }
          })();
          EOF

      # Hata dosyalarını artifact olarak yükle
      - name: Upload error files
        if: failure()
        uses: actions/upload-artifact@v3
        with:
          name: error-files
          path: |
            error_response_*.txt
